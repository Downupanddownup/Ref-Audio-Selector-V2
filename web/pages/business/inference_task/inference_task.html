<!DOCTYPE html>
<script>
    const InferenceTaskSpace = (function () {
        class C_InferenceTask {
            constructor(viewId) {
                this.viewId = viewId
            }
            render() {
                const _this = this
                const getTpl = $('#inferenceTaskTemplate').html();
                // 渲染并输出结果
                layui.laytpl(getTpl).render({}, function(html){
                    const obj = $('#'+_this.viewId)
                    obj.html(html)
                    
                    _this.loadInferenceTaskList()
                    
                    obj.find('#createInferenceTask').on('click', function(){
                        _this.openCreateInferenceTask()
                    })
                });
            }

            loadInferenceTaskList(){
                const height = $('#inferenceTaskList').parent().parent().height() - 50
                // 创建渲染实例
                layui.table.render({
                    elem: '#inferenceTaskList',
                    url: '/static/json/2/table/demo1.json', // 此处为静态模拟数据，实际使用时需换成真实接口
                    height: height, // 最大高度减去其他容器已占有的高度差
                    cellMinWidth: 80,
                    page: true,
                    cols: [[
                        {field:'index', width:'5%', title: '序号'},
                        {field:'taskName', width:'20%', title: '任务名称'},
                        {field:'taskVariable', width:'20%', title: '任务变量'},
                        {field:'hasInference', width:'20%', title: '是否已推理'},
                        {field:'hasCheck', width:'20%', title: '是否已校验'},
                        {field:'opt', width:'20%', title: '操作'},//查看详情，执行推理
                    ]],
                    done: function(){

                    },
                    error: function(res, msg){
                        console.log(res, msg)
                    }
                });
            }

            openCreateInferenceTask(){
                layer.open({
                    type: 1,
                    area: ['90%', '90%'],
                    content: `<div id="createInferenceTaskView"></div>`,
                    btn: ['确定', '取消'],
                    yes: function(){
                        
                    }
                });

                const C_TaskDetail$1 = TaskDetailSpace.getTaskDetail('createInferenceTaskView').render()
            }
            
        }
        
        function getInferenceTask(viewId) {
            return new C_InferenceTask(viewId)
        }
        
        return {
            getInferenceTask: getInferenceTask
        }
    })()
</script>

<script id="inferenceTaskTemplate" type="text/html">
    <button type="submit" class="layui-btn" id="createInferenceTask">创建任务</button>
    <div class="layui-tab-item layui-show" style="height: 500px">
        <table class="layui-hide" id="inferenceTaskList" lay-filter="inferenceTaskList" style="height: 100%"></table>
    </div>
</script>